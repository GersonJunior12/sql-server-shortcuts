sp_executesql N'DECLARE @DataBaseName VARCHAR(100) = '''';DECLARE @FullName VARCHAR(100);DECLARE @Schema VARCHAR(100) = REPLACE(REPLACE(SUBSTRING(@TableName, 0, CHARINDEX(''.'', @TableName)), ''['', ''''), '']'', '''');SET @Schema = IIF(@Schema <> '''', @Schema, ''dbo'');SET @TableName = REPLACE(REPLACE(SUBSTRING(@TableName, CHARINDEX(''.'', @TableName) + 1, LEN(@TableName)), ''['', ''''), '']'', '''');SET @FullName = IIF(@Schema = '''', '''', @Schema + ''.'') + @TableName;IF EXISTS (SELECT 1 FROM TEMPDB.SYS.TABLES WHERE NAME LIKE @TableName + ''%'') BEGIN 	SET @DataBaseName = ''tempdb.'' END;IF EXISTS (SELECT 1 FROM SYS.TABLES WHERE NAME = @TableName AND (@Schema = '''' OR SCHEMA_NAME(SCHEMA_ID) = @Schema)) OR EXISTS (SELECT 1 FROM TEMPDB.SYS.TABLES WHERE NAME LIKE @TableName + ''%'') BEGIN	DECLARE @Query NVARCHAR(MAX) = ''	DECLARE @ObjID INT	SELECT @ObjID = OBJECT_ID	FROM '' + @DataBaseName + ''SYS.TABLES t 	WHERE t.NAME ''+ IIF(@DataBaseName = ''tempdb.'', ''LIKE @TableName + ''''%'''''', ''= @TableName'') +''	AND t.SCHEMA_ID = SCHEMA_ID(''''''+ @Schema +'''''')	SELECT name [Table]	FROM (			SELECT 0 Ordem, ''''CREATE TABLE '''' + '''''' + @FullName + '''''' Name			FROM '' + @DataBaseName + ''SYS.TABLES t 			WHERE T.OBJECT_ID = @ObjID 			UNION ALL 				SELECT 0 Ordem, ''''('''' Name			UNION ALL			SELECT 				ROW_NUMBER() OVER (ORDER BY(c.column_id)) Ordem,				REPLICATE('''' '''', 4) + c.name + '''' '''' + UPPER(tt.name) + IIF(tt.name IN(''''numeric''''), ''''(''''+ CONVERT(VARCHAR, c.precision) + '''', '''' + CONVERT(VARCHAR, c.scale) +'''')'''', IIF(tt.name IN(''''varchar'''', ''''nvarchar'''', ''''char'''', ''''nchar'''', ''''text'''', ''''ntext''''), ''''(''''+ CONVERT(VARCHAR, c.max_length) +'''')'''', '''''''')) + IIF(c.is_identity = 1, '''' IDENTITY'''', '''''''') + IIF(c.is_nullable = 0, '''' NOT NULL'''', '''''''') + '''','''' Name			FROM '' + @DataBaseName + ''SYS.TABLES t 			INNER JOIN '' + @DataBaseName + ''SYS.COLUMNS c ON t.OBJECT_ID = c.OBJECT_ID 			INNER JOIN '' + @DataBaseName + ''SYS.TYPES tt ON tt.system_type_id = c.system_type_id 			WHERE T.OBJECT_ID = @ObjID			UNION ALL 				SELECT 999 Ordem, '''')'''' Name		 ) b	ORDER BY Ordem	SELECT		''''ALTER TABLE '' + @FullName + '' ADD CONSTRAINT ''''+ pk.name +'''' PRIMARY KEY (''''+ c.name +'''')'''' Constraints	FROM '' + @DataBaseName + ''dbo.sysconstraints ct	INNER JOIN '' + @DataBaseName + ''sys.key_constraints pk ON ct.constid = pk.object_id	INNER JOIN '' + @DataBaseName + ''sys.columns c ON c.object_id = pk.parent_object_id AND c.column_id = pk.unique_index_id	WHERE ct.id = @ObjID	UNION ALL	SELECT		''''ALTER TABLE '' + @FullName + '' ADD CONSTRAINT '''' + df.name + '''' DEFAULT ''''+ df.definition +'''' FOR '''' + c.name Constraints	FROM '' + @DataBaseName + ''dbo.sysconstraints ct	INNER JOIN '' + @DataBaseName + ''sys.default_constraints df ON ct.constid = df.object_id	INNER JOIN '' + @DataBaseName + ''sys.columns c ON c.object_id = df.parent_object_id AND c.column_id = ct.colid	WHERE ct.id = @ObjID	UNION ALL	SELECT		''''ALTER TABLE '' + @FullName + '' ADD CONSTRAINT ''''+ fk.name +'''' FOREIGN KEY (''''+ c.name +'''') REFERENCES ''''+ OBJECT_NAME(fk.referenced_object_id) +''''(''''+ c2.name +'''')'''' Constraints	FROM '' + @DataBaseName + ''dbo.sysconstraints ct	INNER JOIN '' + @DataBaseName + ''sys.foreign_keys fk ON ct.constid = fk.object_id	INNER JOIN '' + @DataBaseName + ''sys.columns c ON c.object_id = fk.parent_object_id AND c.column_id = ct.colid	INNER JOIN '' + @DataBaseName + ''sys.columns c2 ON c2.object_id = fk.referenced_object_id AND c2.column_id = fk.key_index_id	WHERE ct.id = @ObjID	SELECT 		''''CREATE ''''+ IIF(i.is_unique = 1, ''''UNIQUE '''', '''''''') + i.type_desc +'''' INDEX ''''+ CAST(i.name COLLATE SQL_Latin1_General_CP850_CI_AI AS VARCHAR) +'''' ON '' + @FullName + ''(''''+ c_principal.name +'''')'''' +		IIF(STRING_AGG(c_included.name, '''', '''') IS NOT NULL, '''' INCLUDE ('''' + STRING_AGG(c_included.name, '''', '''') + '''')'''', '''''''') + IIF(dt.data_space_id IS NOT NULL, '''' ON [''''+ dt.name +'''']'''', '''''''') Indexes	FROM '' + @DataBaseName + ''sys.indexes i	INNER JOIN '' + @DataBaseName + ''sys.index_columns ic_principal ON i.object_id = ic_principal.object_id AND i.index_id = ic_principal.index_id AND key_ordinal = 1	INNER JOIN '' + @DataBaseName + ''sys.columns c_principal ON c_principal.object_id = i.object_id AND c_principal.column_id = ic_principal.column_id	LEFT JOIN '' + @DataBaseName + ''sys.index_columns ic_included ON i.object_id = ic_included.object_id AND i.index_id = ic_included.index_id AND ic_included.is_included_column = 1	LEFT JOIN '' + @DataBaseName + ''sys.columns c_included ON c_included.object_id = i.object_id AND c_included.column_id = ic_included.column_id	LEFT JOIN '' + @DataBaseName + ''sys.data_spaces dt ON dt.data_space_id = i.data_space_id	WHERE i.object_id = @ObjID	GROUP BY i.type_desc, i.name, c_principal.name, i.is_unique, dt.name, dt.data_space_id''	EXEC sp_executesql @Query, N''@TableName nvarchar(776)'', @TableName;END ELSE BEGIN 	EXEC sp_helptext @FullName;END', N'@TableName nvarchar(776)', @TableName = 